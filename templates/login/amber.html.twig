{% extends 'layout.html.twig' %}

{% block title %}Remote Signer Login | Decent Newsroom{% endblock %}

{% block body %}
<div class="container my-5">
  <h1 class="h3 mb-4">Remote Signer</h1>
  <p class="text-muted">Scan the QR below with a NIP-46 compatible bunker signer to pair a remote signing session. Keep this page open while pairing.</p>
  <div class="card">
    <div class="card-body" data-controller="nostr--amber-connect">
      {# Bunker reconnect — for users who already have an active session #}
      <div class="mb-4 p-3" style="background: #f8f9fa;">
        <label for="amber-bunker-input" class="small fw-bold d-block mb-1">Have an existing bunker session?</label>
        <p class="small text-muted mb-2">Paste your <code>bunker://</code> connection string to reconnect.</p>
        <div class="input-group input-group-sm d-flex flex-row">
          <input type="text"
                 id="amber-bunker-input"
                 class="form-control font-monospace small"
                 data-nostr--amber-connect-target="bunkerInput"
                 style="font-size: 0.75rem;"
                 placeholder="bunker://...">
          <button class="btn btn-outline-secondary"
                  type="button"
                  data-action="click->nostr--amber-connect#connectBunker">
            Connect
          </button>
        </div>
      </div>

      <hr class="my-3">
      <p class="text-muted mb-3">Or start a new pairing:</p>
      <div class="row">
        <div class="col-md-6 text-center mb-3">
          <div data-nostr--amber-connect-target="qr" class="mb-2"></div>
          <div class="mt-3">
            <label for="amber-uri-input" class="small text-muted mb-2 d-block">Or copy the connection string:</label>
            <div class="input-group input-group-sm d-flex flex-row">
              <input type="text"
                     id="amber-uri-input"
                     class="form-control font-monospace small"
                     data-nostr--amber-connect-target="uriInput"
                     readonly
                     style="font-size: 0.75rem;"
                     placeholder="Loading...">
              <button class="btn btn-outline-secondary"
                      type="button"
                      data-action="click->nostr--amber-connect#copyUri"
                      data-nostr--amber-connect-target="copyButton">
                Copy
              </button>
            </div>
            <p class="small text-muted mt-1 mb-0">Paste this into your signer app if it's on the same device</p>
          </div>
        </div>
        <div class="col-md-6">
          <h2 class="h6">Status</h2>
          <div data-nostr--amber-connect-target="status" class="small text-muted">Initializing…</div>
          <hr>
          <p class="small text-muted mb-1">After pairing, any page that uses window.nostr will automatically use this remote signer session.</p>
          <p class="small text-muted">If pairing stalls, refresh this page to generate a new ephemeral key.</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

