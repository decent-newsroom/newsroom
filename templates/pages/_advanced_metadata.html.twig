{% block _editor_advancedMetadata_widget %}
    <div class="advanced-metadata-section" {{ stimulus_controller('advanced-metadata') }}>
                <div class="row hidden">
                    <div class="col-md-6">
                        {{ form_row(form.doNotRepublish) }}
                    </div>
                    <div class="col-md-6">
                        {{ form_row(form.license, {
                            'attr': {
                                'data-advanced-metadata-target': 'licenseSelect',
                                'data-action': 'change->advanced-metadata#licenseChanged'
                            }
                        }) }}
                    </div>
                </div>

                <div class="row hidden">
                    <div class="col-md-12">
                        {{ form_row(form.customLicense, {
                            'attr': {
                                'data-advanced-metadata-target': 'customLicenseInput'
                            }
                        }) }}
                    </div>
                </div>


                <h6>Zap Splits</h6>
                <p class="text-muted small">Configure multiple recipients for zaps (tips). Weights determine the split ratio.</p>

                <div data-advanced-metadata-target="zapSplitsContainer"
                     data-prototype="{{ form_widget(form.zapSplits.vars.prototype)|e('html_attr') }}"
                     data-index="{{ form.zapSplits|length }}">
                    {% for zapSplit in form.zapSplits %}
                        <div class="zap-split-item mb-3 p-3 border rounded" data-index="{{ loop.index0 }}">
                            <div class="row">
                                <div class="col-md-5">
                                    {{ form_row(zapSplit.recipient) }}
                                </div>
                                <div class="col-md-4">
                                    {{ form_row(zapSplit.relay) }}
                                </div>
                                <div class="col-md-3">
                                    {{ form_row(zapSplit.weight) }}
                                </div>
                            </div>
                            <button type="button"
                                    class="btn btn-sm btn-danger mt-2"
                                    data-action="click->advanced-metadata#removeZapSplit"
                                    data-index="{{ loop.index0 }}">
                                Remove
                            </button>
                            <div class="zap-share-display mt-2 text-muted">
                                <small>Share: <span class="share-percent">0</span>%</small>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="mb-3">
                    <button type="button"
                            class="btn btn-sm btn-secondary"
                            data-advanced-metadata-target="addZapButton"
                            data-action="click->advanced-metadata#addZapSplit">
                        Add Zap Recipient
                    </button>
                    <button type="button"
                            class="btn btn-sm btn-outline-secondary"
                            data-advanced-metadata-target="distributeEquallyButton"
                            data-action="click->advanced-metadata#distributeEqually">
                        Distribute Equally
                    </button>
                </div>

                <hr class="my-4">

                <div class="row">
                    <div class="col-md-6">
                        {{ form_row(form.contentWarning) }}
                    </div>
                </div>
                <div class="row hidden">
                    <div class="col-md-6">
                        {{ form_row(form.expirationTimestamp, {
                            'attr': {
                                'data-advanced-metadata-target': 'expirationInput',
                                'data-action': 'change->advanced-metadata#expirationChanged'
                            }
                        }) }}
                    </div>
                </div>

                <div class="row hidden">
                    <div class="col-md-12">
                        {{ form_row(form.isProtected, {
                            'attr': {
                                'data-advanced-metadata-target': 'protectedCheckbox',
                                'data-action': 'change->advanced-metadata#protectedChanged'
                            }
                        }) }}
                        <div class="alert alert-warning mt-2"
                             style="display: none;"
                             data-advanced-metadata-target="protectedWarning">
                            <small><strong>Warning:</strong> Some relays may reject protected events. Use with caution.</small>
                        </div>
                    </div>
                </div>
    </div>
{% endblock %}

