{% extends 'layout.html.twig' %}

{% import 'macros/jsonld.html.twig' as jsonld %}

{% block ogtags %}
    <meta property="og:title" content="{{ list.title }} - Newsroom">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ app.request.uri }}">
    <meta property="og:description" content="{{ list.summary ?? '' }}">
    <meta property="og:site_name" content="Newsroom">

    {# BreadcrumbList for navigation #}
    {% set breadcrumbItems = [
        {"name": "Home", "url": url('home')},
        {"name": "Reading Lists", "url": url('lists')},
        {"name": list.title, "url": app.request.uri}
    ] %}
    <script type="application/ld+json">
    {{ jsonld.breadcrumbs(breadcrumbItems)|raw }}
    </script>

    {# JSON-LD Structured Data for Reading List #}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": {{ list.title|json_encode|raw }},
        {% if list.summary %}
        "description": {{ list.summary|json_encode|raw }},
        {% endif %}
        "url": {{ app.request.uri|json_encode|raw }},
        {% if list.pubkey %}
        "author": {{ jsonld.person({'name': list.pubkey|toNpub}, list.pubkey|toNpub)|raw }},
        {% endif %}
        {% if articles is not empty %}
        "numberOfItems": {{ articles|length }},
        "itemListElement": [
            {% for article in articles %}
            {% if article.slug is not empty and article.title is not empty %}
            {{ jsonld.articleListItem(article, loop.index, true)|raw }}{% if not loop.last %},{% endif %}
            {% endif %}
            {% endfor %}
        ]
        {% endif %}
    }
    </script>
{% endblock %}
    </script>
{% endblock %}

{% block body %}
    <section class="d-flex gap-3 center ln-section--newsstand mb-3">
        <div class="container mt-5 mb-5">
            <h1>{{ list.title }}</h1>
            <p class="eyebrow">{{ list.summary }}</p>
        </div>
        <div>by <twig:Molecules:UserFromNpub :ident="list.pubkey" /></div>
    </section>

    <div class="w-container">
        <twig:Organisms:CardList :list="articles" class="article-list" />
    </div>
{% endblock %}
