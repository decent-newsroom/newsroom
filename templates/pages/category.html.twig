{% extends 'layout.html.twig' %}

{% import 'macros/jsonld.html.twig' as jsonld %}

{% block ogtags %}
    <meta property="og:title" content="{{ category.title }} - Newsroom">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ app.request.uri }}">
    <meta property="og:description" content="{{ category.summary ?? '' }}">
    <meta property="og:site_name" content="Newsroom">

    {# BreadcrumbList for navigation #}
    {% set breadcrumbItems = [
        {"name": "Home", "url": url('home')},
        {"name": "Newsstand", "url": url('newsstand')},
        {"name": magazine.title, "url": url('magazine-index', {'mag': mag})},
        {"name": category.title, "url": app.request.uri}
    ] %}
    <script type="application/ld+json">
    {{ jsonld.breadcrumbs(breadcrumbItems)|raw }}
    </script>

    {# JSON-LD Structured Data for Category/Collection Page #}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": {{ category.title|json_encode|raw }},
        {% if category.summary %}
        "description": {{ category.summary|json_encode|raw }},
        {% endif %}
        "url": {{ app.request.uri|json_encode|raw }},
        "isPartOf": {
            "@type": "Periodical",
            "name": {{ magazine.title|json_encode|raw }},
            "url": "{{ url('magazine-index', {'mag': mag}) }}"
        },
        {% if list is defined and list|length > 0 %}
        "mainEntity": {
            "@type": "ItemList",
            "numberOfItems": {{ list|length }},
            "itemListElement": [
                {% for item in list %}
                {% if item.slug is not empty and item.title is not empty %}
                {{ jsonld.articleListItem(item, loop.index, true)|raw }}{% if not loop.last %},{% endif %}
                {% endif %}
                {% endfor %}
            ]
        }
        {% endif %}
    }
    </script>
{% endblock %}

{% block body %}
    <twig:Organisms:MagazineHero :mag="mag" :magazine="magazine"  />
    <div class="w-container">
        <twig:Organisms:CardList :list="list" :category="index" :mag="mag" class="article-list" />
    </div>
{% endblock %}
