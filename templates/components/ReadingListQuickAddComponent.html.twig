<div {{ attributes.defaults({class: 'reading-list-quick-add'}) }}>
    <div class="quick-add-toggle" data-action="live#action" data-live-action-param="toggleExpanded">
        <span class="badge bg-primary">
            Reading List
            {% if itemCount > 0 %}
                <span class="badge bg-secondary ms-1">{{ itemCount }}</span>
            {% endif %}
        </span>
    </div>

    {% if isExpanded %}
        <div class="quick-add-panel card shadow">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="mb-0">Add to Reading List</h6>
                    <button type="button" class="btn-close btn-sm"
                            data-action="live#action"
                            data-live-action-param="toggleExpanded"></button>
                </div>

                <twig:ReadingListSelectorComponent class="mb-3" />

                <form data-action="live#action:prevent" data-live-action-param="addItem">
                    <div class="mb-2">
                        <textarea
                            class="form-control form-control-sm"
                            placeholder="Paste naddr (nostr:naddr1...) or coordinate (30023:pubkey:slug)"
                            rows="3"
                            data-model="norender|input"
                        >{{ input }}</textarea>
                    </div>
                    <button type="submit" class="btn btn-sm btn-primary w-100">Add Article</button>
                </form>

                {% if error %}
                    <div class="alert alert-danger alert-sm mt-2 mb-0">{{ error }}</div>
                {% endif %}
                {% if success %}
                    <div class="alert alert-success alert-sm mt-2 mb-0">{{ success }}</div>
                {% endif %}

                <div class="mt-3 pt-2 border-top">
                    <small class="text-muted d-block mb-2">{{ itemCount }} article{{ itemCount != 1 ? 's' : '' }} in list</small>
                    <div class="d-flex gap-2">
                        <a href="{{ path('reading_list_compose') }}" class="btn btn-sm btn-outline-primary flex-fill">
                            View List
                        </a>
                        <a href="{{ path('read_wizard_review') }}" class="btn btn-sm btn-success flex-fill">
                            Publish
                        </a>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</div>
